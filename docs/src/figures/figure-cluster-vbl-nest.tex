\begin{juliacode}
Pipeline(
  Phase(
    stride = idx[pos[i+1]-1],
    body = begin
      p = pos[i]
      Stepper(
        seek(j) = (p = search(idx, j)),
        stride = idx[p],
        body = Pipeline(
          Phase(
            stride = idx[p]-(ofs[p+1]-ofs[p]),
            body = Run(0)),
          Phase(
            body = Lookup(
              body(j) =
                val[ofs[p+1]+j-idx[p]]))),
        next = p += 1))
  Phase(
    body = Run(0)))
\end{juliacode}