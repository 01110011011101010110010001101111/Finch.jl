\begin{juliacode}
offset = i*(i-1)/2
Pipeline(
  Phase(
    stride = i,
    body = Lookup(
      body(j) = val[offset+j])),
  Phase(
    body = Run(0)))
\end{juliacode}